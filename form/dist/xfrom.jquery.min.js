function xAutoComplete(e){this.opts=e||{},this.eles={$selector:null,$ul:null}}function _getValue(e,t){return"string"==typeof e?e:t?e[t]||e:e}function xCheckbox(e){this.opts=e||{},this.eles={}}function xCombo(e){this.opts={},this.eles={},this.selectedItems=[],this.isFirstTime=!0}function xDate(e){this.opts=e||{},this.eles={}}function xMonth(e){this.opts=e||{},this.eles={}}function xPupSelect(e){this.opts={},e&&(this.opts=e)}function xRadio(e){this.opts=e||{},this.eles={}}function xSelect(e){this.opts=e||{},this.eles={$selector:null,$ul:null}}function xYear(e){this.opts=e||{},this.eles={}}xAutoComplete.prototype.render=function(e){var t=this;this.opts=e;var o=e.selector;e.tField||"text",e.vField||"value",e.vField||"parent",e.subNode,e.value||"",e.isMultiSelect||"N",e.data,e.onFilter,e.onSelect,e.onShow,e.onHide,e.onLoadData;this.eles.$ul=jQuery("<ul></ul"),o.append(this.eles.$ul),this.eles.$text=jQuery(">input",o),this.eles.$selector=o,this.eles.$hValue=jQuery('<input type="hidden" />');var s=this.eles.$text.attr("name");s&&(this.eles.$hValue.attr("name",s),this.eles.$text.attr("name",s+"Desc")),this.eles.$hValue.val(this.opts.value),o.append(this.eles.$hValue),this.eles.$selector.on("click",function(e){var o=t.eles.$ul.is(":visible");o?t.hide():t.show(),""==t.getText()?t.loadData(""):t.renderItems(t.opts.data,function(e){return _getValue(e,t.opts.tField).indexOf(t.getText())>-1}),e.stopPropagation()}),this.eles.$text.keyup(function(e){var o=jQuery(this).val();t.eles.$ul.show(),t.loadData(o)}),this.eles.$ul.hover(function(){},function(){t.hide()})},xAutoComplete.prototype.clearLi=function(){this.eles.$ul.empty()},xAutoComplete.prototype.hide=function(){this.onHide(),this.eles.$ul.hide()},xAutoComplete.prototype.show=function(){this.onShow(),this.eles.$ul.show()},xAutoComplete.prototype.onShow=function(){var onShow=this.opts.onShow;"function"==typeof this.opts.onShow?this.opts.onShow.call(this,me.getValue(),me.getText()):onShow&&eval(onShow+".call(this,this.getValue(),this.getText())")},xAutoComplete.prototype.onSelect=function(){var onSelect=this.opts.onSelect;"function"==typeof this.opts.onSelect?this.opts.onSelect.call(this,me.getValue(),me.getText()):onSelect&&eval(onSelect+".call(this,this.getValue(),this.getText())")},xAutoComplete.prototype.onHide=function(){var onHide=this.opts.onHide;"function"==typeof this.opts.onHide?this.opts.onHide.call(this,me.getValue(),me.getText()):onHide&&eval(onHide+".call(this,this.getValue(),this.getText())")},xAutoComplete.prototype.getValue=function(){return this.eles.$hValue.val()},xAutoComplete.prototype.getText=function(){return this.eles.$text.val()},xAutoComplete.prototype.setValue=function(e,t){var o=this;if(void 0!=e&&this.eles.$hValue.val(e),void 0!=t)this.eles.$text.val(t);else{if(!(this.opts&&this.opts.data&&this.opts.data.length>0))return;for(var s=0;s<this.opts.data.length;s++){var n=this.opts.data[s],t=_getValue(n,o.opts.tField);return void this.eles.$text.val(t)}}},xAutoComplete.prototype.renderItems=function(e,t){var o=this;if(this.eles.$ul.empty(),this.opts&&this.opts.data&&this.opts.data.length>0)for(var s=0;s<this.opts.data.length;s++){var n=this.opts.data[s];t&&0==t(n)||!function(e){var t=o.renderItem(e);o.eles.$ul.append(t)}(n)}},xAutoComplete.prototype.renderItem=function(item){var me=this,$content,renderItem=this.opts.renderItem;if("function"==typeof this.opts.renderItem)$content=this.opts.renderItem.call(this,item);else if(renderItem)eval("$content= "+renderItem+".call(this,item)");else{$content=jQuery("<div></div>");var text=_getValue(item,this.opts.tField),value=_getValue(item,this.opts.vField);$content.html(text),$content.attr("value",value)}var $li=jQuery("<li></li>");return $li.click(function(e){me.setValue(value,text),me.hide(),e.stopPropagation()}),"string"==typeof $content?$li.html($content):$li.append($content)},xAutoComplete.prototype.onItemClick=function(e){_getValue(e,this.opts.tField),_getValue(e,this.opts.vField)},xAutoComplete.prototype.loadData=function(){var me=this;me.clearLi(),this.eles.$ul.append("<li>loadding...</li>");var loadData=this.opts.loadData;"function"==typeof this.opts.loadData?this.opts.loadData.call(this,me.getText()):loadData?eval(" "+loadData+".call(this,this.getText())"):this.renderItems(this.opts.data,function(e){return _getValue(e,me.opts.tField).indexOf(me.getText())>-1})},xAutoComplete.prototype.refresh=function(e){this.opts.data=e,this.renderItems(e)},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.autocomplete=function(window){var controls=[],members={get:function(e){if("number"==typeof e)return controls[e];if("string"==typeof e)e=jQuery(e);else for(var t=0;t<controls.length;t++){var o=controls[t];if(o.opts.selector&&jQuery(o.opts.selector)[0]==jQuery(e)[0])return o}return null},render:function(selector,opts){selector||(selector=".autocomplete"),opts||(opts={});var me=this;jQuery(selector).each(function(item){var $selector=jQuery(this),newOpts={};for(var item in opts)newOpts.item=opts[item];newOpts.tField=$selector.attr("tField"),newOpts.vField=$selector.attr("vField"),newOpts.onShow=$selector.attr("onShow"),newOpts.onHide=$selector.attr("onHide"),newOpts.onSelect=$selector.attr("onSelect"),newOpts.loadData=$selector.attr("loadData"),newOpts.renderItem=$selector.attr("renderItem");var _data={};eval("(_data={data:"+($selector.attr("data")||"[]")+"})"),newOpts.data=_data.data,newOpts.selector=$selector;var xautocomplete=new xAutoComplete(newOpts);controls.push(xautocomplete),xautocomplete.render(newOpts)})}};return members}(window),xCheckbox.prototype.render=function(e){var t=this;this.opts=e||this.opts;var o=e.selector;this.eles.$selector=o,this.eles.$checkbox=jQuery(">label>input[type=checkbox]",o),this.eles.$label=jQuery(">label:first",o),this.opts.isChceked=this.eles.$checkbox.is(":checked"),this.eles.$checkbox.click(function(e){var o=jQuery(this).is(":checked");t.setValue(o),e.stopPropagation()}),this.setValue(this.opts.isChceked)},xCheckbox.prototype.getValue=function(){return this.eles.$checkbox.is(":checked")},xCheckbox.prototype.setValue=function(e){this.eles.$label.removeClass("checked"),1==e&&this.eles.$label.addClass("checked"),this.eles.$checkbox.prop("checked",e),this.onSelect(e)},xCheckbox.prototype.onSelect=function(item){var onSelect=this.opts.onSelect;"function"==typeof this.opts.onSelect?this.opts.onSelect.call(this,me.getValue()):onSelect&&eval(onSelect+".call(this,this.getValue())")},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.checkbox=function(){var e=[],t={get:function(t){if("number"==typeof t)return e[t];if("string"==typeof t)t=jQuery(t);else for(var o=0;o<e.length;o++){var s=e[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(t)[0])return s}return null},render:function(t,o){t||(t=".checkbox"),o||(o={});jQuery(t).each(function(t){var s=jQuery(this),n={};for(var t in o)n.item=o[t];n.onSelect=s.attr("onSelect"),n.selector=s;var r=new xCheckbox(n);e.push(r),r.render(n)})}};return t}(),xCombo.prototype.render=function(opts){var me=this;this.opts=opts;var $selector=opts.selector,tField=opts.tField||"text",vField=opts.vField||"value",pField=opts.vField||"parent",subNode=opts.subNode,value=opts.value||"",isMultiSelect=opts.isMultiSelect||"N",data=opts.data,onFilter=opts.onFilter,onSelect=opts.onSelect,onShow=opts.onShow,onHide=opts.onHide,onLoadData=opts.onLoadData;this.eles.$ul=jQuery("<ul></ul"),$selector.append(this.eles.$ul),this.eles.$text=jQuery(">input",$selector),this.eles.$selector=$selector,this.eles.$hValue=jQuery('<input type="hidden" />');var name=this.eles.$text.attr("name");name&&(this.eles.$hValue.attr("name",name),this.eles.$text.attr("name",name+"Desc")),this.eles.$hValue.val(this.opts.value),$selector.append(this.eles.$hValue),this.eles.$selector.on("click",function(e){var t=me.eles.$ul.is(":visible");t?me.hide():me.show(),e.stopPropagation()}),this.eles.$text.keyup(function(e){var t=jQuery(this).val();me.selectedItems=[],me.clearValue(),me.renderItems(me.opts.data,function(e,o){return me.getParentFilterExpress(e)&&o.indexOf(t)>-1})}),this.eles.$ul.hover(function(){},function(){me.hide()}),this.opts.onLoadData?(this.eles.$ul.append("<li>数据加载中...</li>"),eval(this.opts.onLoadData+".call(this)")):(this.setValue(value),this.renderItems(opts.data))},xCombo.prototype.onFilter=function(e){return!0},xCombo.prototype.isMultiSelect=function(){return"Y"==this.opts.isMultiSelect},xCombo.prototype.getData=function(){return[]},xCombo.prototype.refresh=function(e){this.opts.data=e,this.eles.$ul.append("<li>数据加载中...</li>"),this.setValue(this.getValue()),this.renderItems(e)},xCombo.prototype.renderItems=function(e,t){if(e&&0!=e.length){var o=this;this.eles.$ul.empty();for(var s=0;s<e.length;s++){var n=e[s];!function(e){var s,n,r;if("string"==typeof e?s=n=e:(s=e[o.opts.tField],n=e[o.opts.vField],r=e[o.opts.pField]),!t||0!=t(e,s)){var i=jQuery("<li></li>");o.opts.renderItem&&i.append(o.opts.renderItem(e,s)),o.isMultiSelect()&&i.addClass("item"),i.html(s),i.attr("value",n),i.attr(o.opts.pField,r),i.click(function(t){if(n!=o.getValue()){if("Y"==o.opts.isMultiSelect){var r=i.hasClass("active");r?(o.removeItem(e),i.removeClass("active")):(o.addItem(e),i.addClass("active"))}else o.hide(),o.selectedItems=[],i.siblings().removeClass("active"),i.addClass("active"),o.setValue(n,s);t.stopPropagation()}}),jQuery.inArray(e,o.selectedItems)>-1&&i.addClass("active"),o.eles.$ul.append(i)}}(n)}}},xCombo.prototype.show=function(){this.FilterForParent(),this.eles.$ul.show()},xCombo.prototype.hide=function(){this.eles.$selector.attr("isValid",this.selectedItems.length>0?"Y":"N"),this.eles.$ul.hide()},xCombo.prototype.getValue=function(){return this.eles.$hValue.val()},xCombo.prototype.addItem=function(e){this.selectedItems.push(e),this.renderValue()},xCombo.prototype.removeItem=function(e){for(var t=0;t<this.selectedItems.length;t++){var o=this.selectedItems[t];o==e&&this.selectedItems.splice(t,1)}this.renderValue()},xCombo.prototype.selectedItems=[],xCombo.prototype.setValue=function(e,t){var o=this;if(t&&this.eles.$text.val(t),this.opts&&this.opts.data)for(var s=0;s<this.opts.data.length;s++){var n,r=this.opts.data[s];n="string"==typeof r?r:r[o.opts.vField],n&&e.toString().indexOf(n.toString())>-1&&this.selectedItems.push(r)}this.renderValue()},xCombo.prototype.clearValue=function(){this.eles.$hValue.val(""),this.setSubCombo()},xCombo.prototype.renderValue=function(){for(var e=this,t=[],o=[],s=0;s<this.selectedItems.length;s++){var n,r,i=this.selectedItems[s];"string"==typeof i?r=n=i:(r=i[e.opts.tField],n=i[e.opts.vField]),t.push(r),o.push(n)}this.eles.$text.val(t.join(",")),this.eles.$hValue.val(o.join(",")),this.opts.onSelect&&this.opts.onSelect.call(this),this.setSubCombo()},xCombo.prototype.getParentFilterExpress=function(e){if($parentNode=jQuery(".combo[id="+this.eles.$selector.attr("pId")+"]"),$parentNode&&$parentNode.length>0){var t=combo.get($parentNode);if(t){var o=t.getValue(),s=this.opts.pField;return o.toString().indexOf(e[s])>-1}}return!0},xCombo.prototype.FilterForParent=function(){var e=this;this.renderItems(this.opts.data,function(t){return e.getParentFilterExpress(t)})},xCombo.prototype.isFirstTime=!0,xCombo.prototype.setSubCombo=function(){if(this.isFirstTime)return void(this.isFirstTime=!1);var e=this;if($subNode=jQuery(".combo[pId="+this.eles.$selector.attr("id")+"]"),$subNode&&$subNode.length>0){var t=combo.get($subNode);if(t){var o=(this.getValue(),$subNode.attr("pField"));t.renderItems(t.opts.data,function(t){return t[o]==e.getValue()}),t.selectedItems=[],t.setValue("")}}},"undefined"!=typeof window.xForm&&(window.xForm.combo=function(){var combos=[],members={get:function(e){if("number"==typeof e)return combos[e];if("string"==typeof e)e=jQuery(e);else for(var t=0;t<combos.length;t++){var o=combos[t];if(o.opts.selector&&jQuery(o.opts.selector)[0]==jQuery(e)[0])return o}return null},render:function(selector){selector||($selectors=jQuery(".combo"));for(var me=this,i=0;i<$selectors.length;i++)!function(i){var seletor=$selectors[i],$seletor=jQuery(seletor),opts={};opts.selector=$seletor,opts.tField=$seletor.attr("tField");var _data={};eval("(_data={data:"+($seletor.attr("data")||"[]")+"})"),opts.data=_data.data,opts.vField=$seletor.attr("vField"),opts.onLoadData=$seletor.attr("onLoadData"),opts.pField=$seletor.attr("pField"),opts.subNode=$seletor.attr("subNode"),opts.value=$seletor.attr("value")||jQuery(">input:first",$seletor).val(),opts.isMultiSelect=$seletor.attr("isMultiSelect");var xcombox=new xCombo;opts.onSelect=function(){var me=this,onSelect=this.eles.$selector.attr("onSelect");onSelect&&eval(onSelect+".call($seletor,me.getValue(),me.getText())")},combos.push(xcombox),xcombox.render(opts)}(i)},getValue:function(e){},setValue:function(e){}};return members}());var _getSelector=function(e){return"string"==typeof e?jQuery(e):e};xDate.prototype.weeks=["一","二","三","四","五","六","日"],xDate.prototype.dates=["年","月","日"],xDate.prototype.render=function(e){this.opts=e||{};var t=this,o=_getSelector(e.selector);this.eles.$selector=o,this.eles.$date=jQuery('<div class="body"></div>'),this.eles.$text=jQuery("input:first",o),this.eles.$text.attr("readonly","readonly"),this.opts.value&&this.setValue(this.opts.value),this.opts.value=this.opts.value||this.getValue(),this.eles.$date.click(function(e){e.stopPropagation()}),this.eles.$selector.append(this.eles.$date),o.click(function(e){var o=jQuery(this).attr("isShow");"Y"==o?t.hide():t.show(),e.stopPropagation()})},xDate.prototype.show=function(){this.eles.$date.show(),this.renderHeader(),this.renderContent(this.getValue()),this.renderFooter(),this.eles.$selector.attr("isShow","Y")},xDate.prototype.hide=function(){this.eles.$date.empty(),this.eles.$date.hide(),this.eles.$selector.attr("isShow","N")},xDate.prototype.getCurrentDateText=function(e){var t=e?"string"==typeof e?new Date(e):e:new Date;this.opts.currentDate=t;var o=jQuery('<div class="title "></div>'),s=jQuery('<span class="year pt"></span>');s.html(this.getYear(t)+this.dates[0]);var n=jQuery('<span class="month pt"></span>');n.html(this.getMonth(t)+1+this.dates[1]);var r=jQuery('<span class="day pt"></span>');r.html(this.getDay(t)+this.dates[2]),o.append(s).append(n).append(r);var i=this;return s.click(function(){i.renderYearContent()}),n.click(function(){i.renderMonthContent()}),r.click(function(){var e=new Date;i.opts.currentDate=e,i.renderContent(i.opts.currentDate)}),o},xDate.prototype.renderHeader=function(){var e=this,t=jQuery('<div class="header" ></div>'),o=jQuery('<span class="left pt"></span>'),s=jQuery('<span class="content"></span>');this.eles.$headerContent=s,this.opts.currentDate=new Date(this.getValue());var n=jQuery('<span class="right pt"></span>');o.click(function(){"month"==e.opts.status?e.divMonth(1):"year"==e.opts.status&&e.divYear()}),n.click(function(){"month"==e.opts.status?e.addMonth(1):"year"==e.opts.status&&e.addYear()}),t.append(o),t.append(s),t.append(n),this.eles.$date.append(t)},xDate.prototype.setTitle=function(){this.eles.$headerContent.empty(),this.eles.$headerContent.html(this.getCurrentDateText(this.opts.currentDate))},xDate.prototype.addYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t+=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xDate.prototype.divYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t-=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xDate.prototype.addMonth=function(e){var t=this.getYear(this.opts.currentDate),o=this.getMonth(this.opts.currentDate);this.getDay(this.opts.currentDate);11==o?(t+=1,o=0):o+=e||1;var s=new Date(t,o,1);this.opts.currentDate=s,this.renderContent(this.opts.currentDate),this.setTitle()},xDate.prototype.divMonth=function(e){var t=this.getYear(this.opts.currentDate),o=this.getMonth(this.opts.currentDate);this.getDay(this.opts.currentDate);0==o?(t-=1,o=11):o-=e||1;var s=new Date(t,o,1);this.opts.currentDate=s,this.renderContent(this.opts.currentDate),this.setTitle()},xDate.prototype.removeAllEles=function(){this.eles.$content&&this.eles.$content.remove(),this.eles.$monthContent&&this.eles.$monthContent.remove(),this.eles.$yearContent&&this.eles.$yearContent.remove()},xDate.prototype.renderYearContent=function(){this.removeAllEles(),this.opts.status="year";var e=this,t=this.eles.$yearContent;t&&t.remove(),t=jQuery('<div class="yearContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getYear(s),r=n-12;r<n+13;r++){var i=jQuery("<li></li>");i.html(r),o.append(i),r==n&&i.addClass("active"),function(o,s){o.click(function(){e.opts.currentDate.setFullYear(s),e.eles.$monthContent&&e.eles.$monthContent.show(),t.remove(),e.renderContent(e.opts.currentDate)})}(i,r)}t.append(o),t.show(),this.eles.$yearContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$monthContent&&this.eles.$monthContent.hide(),e.setTitle()},xDate.prototype.renderMonthContent=function(){this.removeAllEles();var e=this,t=this.eles.$monthContent;t&&t.remove(),t=jQuery('<div class="monthContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getMonth(s),r=0;r<12;r++){var i=jQuery("<li></li>");i.html(r+1),o.append(i),r==n&&i.addClass("active"),function(o,s){o.click(function(){e.opts.currentDate.setMonth(s),t.remove(),e.renderContent(e.opts.currentDate)})}(i,r)}t.append(o),t.show(),this.eles.$monthContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$yearContent&&this.eles.$yearContent.hide()},xDate.prototype.renderContent=function(e){this.removeAllEles(),this.opts.status="month";var t=this;this.eles.$content&&this.eles.$content.empty();var o=jQuery('<div class="content"></div>');this.eles.$content=o;var s=jQuery("<ul></ul>"),e="string"==typeof e&&e?new Date(e):e||new Date;this.opts.currentDate=e;for(var n=(this.getWeek(e),this.getYear(e)),r=this.getMonth(e),i=this.getDay(e),a=this.getDayArray(n,r),l=0;l<this.weeks.length;l++){var h=jQuery("<li></li>");h.html(this.weeks[l]),s.append(h)}for(var l=0;l<a.length;l++){var h=jQuery("<li></li>"),u=a[l],p=u.value,c=h;h.html(u.day),s.append(h),h.removeClass("currentDay"),u.isCurrentMonth&&i==u.day?h.addClass("currentDay"):u.isCurrentMonth||h.addClass("isNotCurrentMonth"),function(o,s){s.click(function(s){t.setValue(o),t.hide(),t.opts.currentDate=e})}(p,c)}o.append(s),this.eles.$date.append(o),this.setTitle()},xDate.prototype.renderFooter=function(){},xDate.prototype.formatDate=function(e){return this.getYear(e)+"-"+(this.getMonth(e)+1)+"-"+this.getDay(e)},xDate.prototype.renderYear=function(){},xDate.prototype.getDayArray=function(e,t){for(var o=new Date(e,t,1),s=this.getWeek(o),n=this.getMaxDays(0==t?e-1:e,0==t?11:t-1),r=[],i=n+1+(0==s?-6:1-s);i<n+1;i++)r.push({day:i,isCurrentMonth:!1,value:(0==t?e-1:e)+"-"+(0==t?12:t)+"-"+i});for(var a=this.getMaxDays(e,t),i=1;i<=a;i++)r.push({day:i,isCurrentMonth:!0,value:e+"-"+(t+1)+"-"+i});for(var i=1;i<32&&r.length%7!=0;i++)r.push({day:i,isCurrentMonth:!1,value:(t+2==13?e+1:e)+"-"+(t+2==13?1:t+2)+"-"+i});return r},xDate.prototype.renderMonth=function(){},xDate.prototype.renderDay=function(){},xDate.prototype.setValue=function(e){return this.eles.$text.val(e)},xDate.prototype.getValue=function(){return this.eles.$text.val()},xDate.prototype.getMaxDays=function(e,t){return new Date(e,t+1,0).getDate()},xDate.prototype.getWeek=function(e){return e.getDay()},xDate.prototype.getMonth=function(e){return e.getMonth()},xDate.prototype.getYear=function(e){return e.getFullYear()},xDate.prototype.getDay=function(e){return e.getDate()},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.date=function(){var e=[],t={get:function(t){if("number"==typeof t)return e[t];if("string"==typeof t)t=jQuery(t);else for(var o=0;o<e.length;o++){var s=e[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(t)[0])return s}return null},render:function(t,o){t||(t=".date"),o||(o={});jQuery(t).each(function(t){var s=jQuery(this),n={};for(var t in o)n.item=o[t];n.onSelect=s.attr("onSelect"),n.selector=s;var r=new xDate(n);e.push(r),r.render(n)})}};return t}();var xForm=function(e){var t={date:null,select:null,combo:null,autocomplete:null,checkbox:null,radio:null,init:function(){this.initUI("date"),this.initUI("select"),this.initUI("combo"),this.initUI("autocomplete"),this.initUI("checkbox"),this.initUI("radio"),this.initUI("month")},initUI:function(e){this[e]="undefined"!=typeof xUi&&"undefined"!=typeof xUi[e]?xUi[e]:{render:function(){}},this[e].render&&this[e].render()},render:function(){this.init()}};return t}(window);jQuery(function(){xForm.render()});var _getSelector=function(e){return"string"==typeof e?jQuery(e):e};xMonth.prototype.dates=["年","月","日"],xMonth.prototype.render=function(e){this.opts=e||{};var t=this,o=_getSelector(e.selector);this.eles.$selector=o,this.eles.$date=jQuery('<div class="body"></div>');var s,n,r=jQuery("input",o);r.size()>1?(r=jQuery('<input type="text" />'),s=jQuery("[dateType=year]",o)||jQuery(r)[0],n=jQuery("[dateType=month]",o)||jQuery(r)[1],s.attr("type","hidden"),n.attr("type","hidden")):(s=jQuery('<input type="hidden" />'),n=jQuery('<input type="hidden" />')),this.eles.$text=jQuery("input:first",o),this.eles.$text.attr("readonly","readonly"),this.opts.value&&this.setValue(this.opts.value),this.opts.value=this.opts.value||this.getValue(),this.eles.$date.click(function(e){e.stopPropagation()}),this.eles.$selector.append(this.eles.$date),o.click(function(e){var o=jQuery(this).attr("isShow");"Y"==o?t.hide():t.show(),e.stopPropagation()})},xMonth.prototype.show=function(){this.eles.$date.show(),this.opts.isOnly||this.renderHeader(),this.renderContent(this.getValue()),this.renderFooter(),this.eles.$selector.attr("isShow","Y")},xMonth.prototype.hide=function(){this.eles.$date.empty(),this.eles.$date.hide(),this.eles.$selector.attr("isShow","N")},xMonth.prototype.getCurrentDateText=function(e){var t=e?"string"==typeof e?new Date(e):e:new Date;this.opts.currentDate=t;var o=jQuery('<div class="title "></div>'),s=jQuery('<span class="year pt"></span>');s.html(this.getYear(t)+this.dates[0]);var n=jQuery('<span class="month pt"></span>');n.html(this.getMonth(t)+1+this.dates[1]);var r=this;return s.click(function(){r.renderYearContent()}),n.click(function(){r.renderMonthContent()}),o.append(s),o.append(n),o},xMonth.prototype.renderHeader=function(){var e=this,t=jQuery('<div class="header" ></div>'),o=jQuery('<span class="left pt"></span>'),s=jQuery('<span class="content"></span>');this.eles.$headerContent=s,this.opts.currentDate=new Date(this.getValue());var n=jQuery('<span class="right pt"></span>');o.click(function(){"month"==e.opts.status?e.divMonth(1):"year"==e.opts.status&&e.divYear()}),n.click(function(){"month"==e.opts.status?e.addMonth(1):"year"==e.opts.status&&e.addYear()}),t.append(o),t.append(s),t.append(n),this.eles.$date.append(t)},xMonth.prototype.setTitle=function(){this.opts.isOnly||(this.eles.$headerContent.empty(),this.eles.$headerContent.html(this.getCurrentDateText(this.opts.currentDate)))},xMonth.prototype.addYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t+=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xMonth.prototype.divYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t-=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xMonth.prototype.removeAllEles=function(){this.eles.$monthContent&&this.eles.$monthContent.remove(),this.eles.$yearContent&&this.eles.$yearContent.remove()},xMonth.prototype.renderYearContent=function(){this.removeAllEles(),this.opts.status="year";var e=this,t=this.eles.$yearContent;t&&t.remove(),t=jQuery('<div class="yearContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getYear(s),r=n-12;r<n+13;r++){var i=jQuery("<li></li>");i.html(r),o.append(i),r==n&&i.addClass("active"),function(o,s){o.click(function(){e.opts.currentDate.setFullYear(s),e.eles.$monthContent&&e.eles.$monthContent.show(),t.remove(),e.renderContent(e.opts.currentDate)})}(i,r)}t.append(o),t.show(),this.eles.$yearContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$monthContent&&this.eles.$monthContent.hide(),e.setTitle()},xMonth.prototype.renderMonthContent=function(){this.removeAllEles();var e=this,t=this.eles.$monthContent;t&&t.remove(),t=jQuery('<div class="monthContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getMonth(s),r=0;r<12;r++){var i=jQuery("<li></li>");i.html(r+1),o.append(i),r==n&&i.addClass("active"),function(t,o){t.click(function(){e.opts.currentDate.setMonth(o),e.setTitle(),t.siblings().removeClass("active"),t.addClass("active");var s=e.opts.isOnly?e.getMonth(e.opts.currentDate)+1:e.formatDate(e.opts.currentDate);e.setValue(s),e.hide()})}(i,r)}t.append(o),t.show(),this.eles.$monthContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$yearContent&&this.eles.$yearContent.hide()},xMonth.prototype.renderContent=function(e){this.removeAllEles(),this.opts.status="year";var e="string"==typeof e&&e?new Date(e):e||new Date;this.opts.currentDate=e,this.renderMonthContent(),this.setTitle()},xMonth.prototype.renderFooter=function(){},xMonth.prototype.formatDate=function(e){return this.getYear(e)+"-"+(this.getMonth(e)+1)},xMonth.prototype.setValue=function(e){return this.eles.$text.val(e)},xMonth.prototype.getValue=function(){return this.eles.$text.val()},xMonth.prototype.getMonth=function(e){return e.getMonth()},xMonth.prototype.getYear=function(e){return e.getFullYear()},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.month=function(){var e=[],t={get:function(t){if("number"==typeof t)return e[t];if("string"==typeof t)t=jQuery(t);else for(var o=0;o<e.length;o++){var s=e[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(t)[0])return s}return null},render:function(t,o){t||(t=".month"),o||(o={});jQuery(t).each(function(t){var s=jQuery(this),n={};for(var t in o)n.item=o[t];n.onSelect=s.attr("onSelect"),n.isOnly=s.attr("isOnly"),n.selector=s;var r=new xMonth(n);e.push(r),r.render(n)})}};return t}(),xPupSelect.prototype.render=function(e){e.tField,e.vField},xPupSelect.prototype.getValue=function(){},xPupSelect.prototype.setValue=function(e){},xPupSelect.prototype.renderItem=function(e){},xPupSelect.prototype.onItemClick=function(){},xPupSelect.prototype.loadData=function(){},xPupSelect.prototype.refresh=function(e){},xRadio.prototype.render=function(e){var t=this;this.opts=e||this.opts;var o=e.selector;this.eles.$selector=o,this.eles.$radio=jQuery(">label>input[type=radio]",o),this.eles.$label=jQuery(">label:first",o),this.opts.isChceked=this.eles.$radio.is(":checked"),this.eles.$radio.click(function(e){t.setValue(),e.stopPropagation()}),this.setValue()},xRadio.prototype.getValue=function(){return this.eles.$radio.is(":checked")},xRadio.prototype.setValue=function(e){e?this.eles.$radio.each(function(){var t=jQuery(this).val();jQuery(this).prop("checked",!1),jQuery(this).parent().removeClass("checked"),e==t&&(jQuery(this).prop("checked",!0),jQuery(this).parent().addClass("checked"))}):(e=[],this.eles.$radio.each(function(){var t=jQuery(this).is(":checked");if(jQuery(this).prop("checked",!1),jQuery(this).parent().removeClass("checked"),t){var o=jQuery(this).val();jQuery(this).prop("checked",!0),e.push(o),jQuery(this).parent().addClass("checked")}}),e=e.join(",")),console&&console.log&&console.log("xform radio value:"+e),this.onSelect(e)},xRadio.prototype.onSelect=function(item){var onSelect=this.opts.onSelect;"function"==typeof this.opts.onSelect?this.opts.onSelect.call(this,me.getValue()):onSelect&&eval(onSelect+".call(this,this.getValue())")},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.radio=function(){var e=[],t={get:function(t){if("number"==typeof t)return e[t];if("string"==typeof t)t=jQuery(t);else for(var o=0;o<e.length;o++){var s=e[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(t)[0])return s}return null},render:function(t,o){t||(t=".radio"),o||(o={});jQuery(t).each(function(t){var s=jQuery(this),n={};for(var t in o)n.item=o[t];n.onSelect=s.attr("onSelect"),n.selector=s;var r=new xRadio(n);e.push(r),r.render(n)})}};return t}(),xSelect.prototype.hide=function(){this.onHide(),this.eles.$ul.hide()},xSelect.prototype.show=function(){this.parentFilter(),this.onShow(),this.eles.$ul.show()},xSelect.prototype.render=function(e){var t=this,o=e.selector;e.onShow||function(){},e.onHide||function(){};this.opts=e;var s=o,n=jQuery(">ul",s);this.eles.$ul=n,this.eles.$selector=s;var r=jQuery(">li",n),i=jQuery(">input",s),a=s.attr("rendered");if("Y"!=a){this.eles.$text=i;var l=jQuery('<input type="hidden" />');this.eles.$hValue=l;var h=i.attr("name");h&&(l.attr("name",h),i.attr("name",h+"Desc")),s.append(l),n.css("top",s.height()+2+"px");var u=i.val()||s.attr("value");if(s.attr("rendered","Y"),void 0==u||""==u){var p=jQuery(">li[isSelected=Y]",n);if(p.size()>0){var c=0==p.attr("value")?p.text():p.attr("value");p.attr("value")!=c&&p.attr("value",c),u=c}}t.setValue(u,!0),s.on("click",function(e){var o=n.is(":visible");o?t.hide():t.show(),e.stopPropagation()}),r.on("click",function(e){var o=0==jQuery(this).attr("value")?jQuery(this).text():jQuery(this).attr("value"),s=t.getValue();s!=o&&(jQuery(this).attr("value")!=o&&jQuery(this).attr("value",o),t.setValue(o),t.hide(),e.stopPropagation())})}},xSelect.prototype.refresh=function(){},xSelect.prototype.filter=function(){},xSelect.prototype.setSubValue=function(){this.opts.subSelect&&this.opts.subSelect.setValue("")},xSelect.prototype.parentFilter=function(){if(this.opts.parentSelect){var e=this.opts.parentSelect.getValue();jQuery(">li",this.eles.$ul).hide(),jQuery(">li["+this.opts.pField+"="+e+"]",this.eles.$ul).show()}},xSelect.prototype.getValue=function(){return this.eles.$hValue.val()},xSelect.prototype.getText=function(){return this.eles.$text.val()},xSelect.prototype.onShow=function(){var onShow=this.opts.onShow;onShow&&eval(onShow+".call(this)")},xSelect.prototype.onHide=function(){var onHide=this.opts.onHide;onHide&&eval(onHide+".call(this)")},xSelect.prototype.setValue=function(e){var t=this.eles.$selector,o=jQuery(">ul",t),s=(jQuery(">li",o),jQuery(">input:first",t)),n=jQuery(">input[type=hidden]",t),r=jQuery(">li[value="+e+"]",o).text();r?(s.val(r),n.val(e)):(s.val(e),n.val(e)),this.onSelect(),this.setSubValue()},xSelect.prototype.onSelect=function(){var onSelect=this.opts.onSelect;"function"==typeof this.opts.onSelect?this.opts.onSelect.call(this,me.getValue(),me.getText()):onSelect&&eval(onSelect+".call(this,this.getValue(),this.getText())")},xSelect.prototype.onItemClick=function(){},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.select=function(e){var t=[],o={get:function(e){if("number"==typeof e)return t[e];if("string"==typeof e)e=jQuery(e);else for(var o=0;o<t.length;o++){var s=t[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(e)[0])return s}return null},getSubSelect:function(e){return $subNode=jQuery(".select[pId="+e.attr("id")+"]"),this.get($subNode)},getParentSelect:function(e){$parentNode=jQuery(".select[id="+e.attr("pId")+"]");var t=this.get($parentNode);return t&&(t.opts.subSelect=this.get(e)),t},render:function(e,o){e||(e=".select"),o||(o={});var s=this;jQuery(e).each(function(e){var n=jQuery(this),r={};r.pField=n.attr("pField"),r.onShow=n.attr("onShow"),r.onHide=n.attr("onHide"),r.onSelect=n.attr("onSelect"),r.selector=n;for(var e in o)r.item=o[e];var i=new xSelect(r);t.push(i),i.render(r),r.subSelect=s.getSubSelect(n),r.parentSelect=s.getParentSelect(n)})}};return o}(window);var xFormUtils=function(){var e={call:function(){},getSelector:function(e){}};return e}(),_getSelector=function(e){return"string"==typeof e?jQuery(e):e};xYear.prototype.dates=["年","月","日"],xYear.prototype.render=function(e){this.opts=e||{};var t=this,o=_getSelector(e.selector);this.eles.$selector=o,this.eles.$date=jQuery('<div class="body"></div>');var s,n,r=jQuery("input",o);r.size()>1?(r=jQuery('<input type="text" />'),s=jQuery("[dateType=year]",o)||jQuery(r)[0],
n=jQuery("[dateType=month]",o)||jQuery(r)[1],s.attr("type","hidden"),n.attr("type","hidden")):(s=jQuery('<input type="hidden" />'),n=jQuery('<input type="hidden" />')),this.eles.$text=jQuery("input:first",o),this.eles.$text.attr("readonly","readonly"),this.opts.value&&this.setValue(this.opts.value),this.opts.value=this.opts.value||this.getValue(),this.eles.$date.click(function(e){e.stopPropagation()}),this.eles.$selector.append(this.eles.$date),o.click(function(e){var o=jQuery(this).attr("isShow");"Y"==o?t.hide():t.show(),e.stopPropagation()})},xYear.prototype.show=function(){this.eles.$date.show(),this.opts.isOnly||this.renderHeader(),this.renderContent(this.getValue()),this.renderFooter(),this.eles.$selector.attr("isShow","Y")},xYear.prototype.hide=function(){this.eles.$date.empty(),this.eles.$date.hide(),this.eles.$selector.attr("isShow","N")},xYear.prototype.getCurrentDateText=function(e){var t=e?"string"==typeof e?new Date(e):e:new Date;this.opts.currentDate=t;var o=jQuery('<div class="title "></div>'),s=jQuery('<span class="year pt"></span>');s.html(this.getYear(t)+this.dates[0]);var n=jQuery('<span class="month pt"></span>');n.html(this.getMonth(t)+1+this.dates[1]);var r=this;return s.click(function(){r.renderYearContent()}),n.click(function(){r.renderMonthContent()}),o.append(s),o.append(n),o},xYear.prototype.renderHeader=function(){var e=this,t=jQuery('<div class="header" ></div>'),o=jQuery('<span class="left pt"></span>'),s=jQuery('<span class="content"></span>');this.eles.$headerContent=s,this.opts.currentDate=new Date(this.getValue());var n=jQuery('<span class="right pt"></span>');o.click(function(){"month"==e.opts.status?e.divMonth(1):"year"==e.opts.status&&e.divYear()}),n.click(function(){"month"==e.opts.status?e.addMonth(1):"year"==e.opts.status&&e.addYear()}),t.append(o),t.append(s),t.append(n),this.eles.$date.append(t)},xYear.prototype.setTitle=function(){this.opts.isOnly||(this.eles.$headerContent.empty(),this.eles.$headerContent.html(this.getCurrentDateText(this.opts.currentDate)))},xYear.prototype.addYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t+=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xYear.prototype.divYear=function(){var e=25,t=this.getYear(this.opts.currentDate);t-=e,this.opts.currentDate.setFullYear(t),this.renderYearContent()},xYear.prototype.removeAllEles=function(){this.eles.$monthContent&&this.eles.$monthContent.remove(),this.eles.$yearContent&&this.eles.$yearContent.remove()},xYear.prototype.renderYearContent=function(){this.removeAllEles(),this.opts.status="year";var e=this,t=this.eles.$yearContent;t&&t.remove(),t=jQuery('<div class="yearContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getYear(s),r=n-12;r<n+13;r++){var i=jQuery("<li></li>");i.html(r),o.append(i),r==n&&i.addClass("active"),function(o,s){o.click(function(){e.opts.currentDate.setFullYear(s),e.eles.$monthContent&&e.eles.$monthContent.show(),t.remove(),e.renderContent(e.opts.currentDate)})}(i,r)}t.append(o),t.show(),this.eles.$yearContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$monthContent&&this.eles.$monthContent.hide(),e.setTitle()},xYear.prototype.renderMonthContent=function(){this.removeAllEles();var e=this,t=this.eles.$monthContent;t&&t.remove(),t=jQuery('<div class="monthContent"></div>');for(var o=jQuery("<ul></ul>"),s=this.opts.currentDate,n=this.getMonth(s),r=0;r<12;r++){var i=jQuery("<li></li>");i.html(r+1),o.append(i),r==n&&i.addClass("active"),function(t,o){t.click(function(){e.opts.currentDate.setMonth(o),e.setTitle(),t.siblings().removeClass("active"),t.addClass("active");var s=e.opts.isOnly?e.getMonth(e.opts.currentDate)+1:e.formatDate(e.opts.currentDate);e.setValue(s),e.hide()})}(i,r)}t.append(o),t.show(),this.eles.$monthContent=t,this.eles.$date.append(t),this.eles.$content&&this.eles.$content.hide(),this.eles.$yearContent&&this.eles.$yearContent.hide()},xYear.prototype.renderContent=function(e){this.removeAllEles(),this.opts.status="year";var e="string"==typeof e&&e?new Date(e):e||new Date;this.opts.currentDate=e,this.renderMonthContent(),this.setTitle()},xYear.prototype.renderFooter=function(){},xYear.prototype.formatDate=function(e){return this.getYear(e)+"-"+(this.getMonth(e)+1)},xYear.prototype.setValue=function(e){return this.eles.$text.val(e)},xYear.prototype.getValue=function(){return this.eles.$text.val()},xYear.prototype.getMonth=function(e){return e.getMonth()},xYear.prototype.getYear=function(e){return e.getFullYear()},"undefined"==typeof window.xUi&&(window.xUi={}),window.xUi.year=function(){var e=[],t={get:function(t){if("number"==typeof t)return e[t];if("string"==typeof t)t=jQuery(t);else for(var o=0;o<e.length;o++){var s=e[o];if(s.opts.selector&&jQuery(s.opts.selector)[0]==jQuery(t)[0])return s}return null},render:function(t,o){t||(t=".year"),o||(o={});jQuery(t).each(function(t){var s=jQuery(this),n={};for(var t in o)n.item=o[t];n.onSelect=s.attr("onSelect"),n.isOnly=s.attr("isOnly"),n.selector=s;var r=new xYear(n);e.push(r),r.render(n)})}};return t}();